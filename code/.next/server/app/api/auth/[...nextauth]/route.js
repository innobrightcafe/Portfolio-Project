"use strict";(()=>{var e={};e.id=912,e.ids=[912],e.modules={11185:e=>{e.exports=require("mongoose")},72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},14300:e=>{e.exports=require("buffer")},6113:e=>{e.exports=require("crypto")},82361:e=>{e.exports=require("events")},13685:e=>{e.exports=require("http")},95687:e=>{e.exports=require("https")},73837:e=>{e.exports=require("util")},59796:e=>{e.exports=require("zlib")},45644:(e,t,r)=>{r.r(t),r.d(t,{headerHooks:()=>d,originalPathname:()=>g,patchFetch:()=>h,requestAsyncStorage:()=>p,routeModule:()=>u,serverHooks:()=>l,staticGenerationAsyncStorage:()=>c,staticGenerationBailout:()=>m});var n={};r.r(n),r.d(n,{GET:()=>o.HT,POST:()=>o.a4});var i=r(95419),a=r(69108),s=r(99678),o=r(14318);let u=new i.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/auth/[...nextauth]/route",pathname:"/api/auth/[...nextauth]",filename:"route",bundlePath:"app/api/auth/[...nextauth]/route"},resolvedPagePath:"/home/inosoft/Documents/project/ALXFINALPROJECT/Portfolio-Project/code/src/app/api/auth/[...nextauth]/route.js",nextConfigOutput:"",userland:n}),{requestAsyncStorage:p,staticGenerationAsyncStorage:c,serverHooks:l,headerHooks:d,staticGenerationBailout:m}=u,g="/api/auth/[...nextauth]/route";function h(){return(0,s.patchFetch)({serverHooks:l,staticGenerationAsyncStorage:c})}},95419:(e,t,r)=>{e.exports=r(30517)},14318:(e,t,r)=>{r.d(t,{HT:()=>d,a4:()=>m,I8:()=>g,zB:()=>h,w7:()=>x});var n=r(30882),i=r(83764),a=r(3133),s=r(78596),o=r(45989),u=r(6521),p=r.n(u);let c={pages:{signIn:"/login"},providers:[],callbacks:{jwt:async({token:e,user:t})=>(t&&(e.id=t.id,e.isAdmin=t.isAdmin),e),session:async({session:e,token:t})=>(t&&(e.user.id=t.id,e.user.isAdmin=t.isAdmin),e),authorized({auth:e,request:t}){let r=e?.user,n=t.nextUrl?.pathname.startsWith("/admin"),i=t.nextUrl?.pathname.startsWith("/blog"),a=t.nextUrl?.pathname.startsWith("/login");return(!n||!!r?.isAdmin)&&(!i||!!r)&&(!a||!r||Response.redirect(new URL("/",t.nextUrl)))}}},l=async e=>{try{(0,s.T)();let t=await o.n.findOne({username:e.username});if(!t||!await p().compare(e.password,t.password))throw Error("Wrong credentials!");return t}catch(e){throw console.log(e),Error("Failed to login!")}},{handlers:{GET:d,POST:m},auth:g,signIn:h,signOut:x}=(0,n.Z)({...c,providers:[(0,i.Z)({clientId:process.env.GITHUB_ID,clientSecret:process.env.GITHUB_SECRET}),(0,a.Z)({async authorize(e){try{return await l(e)}catch(e){return null}}})],callbacks:{async signIn({user:e,account:t,profile:r}){if("github"===t.provider){(0,s.T)();try{if(!await o.n.findOne({email:r.email})){let e=new o.n({username:r.login,email:r.email,image:r.avatar_url});await e.save()}}catch(e){return console.log(e),!1}}return!0},...c.callbacks}})},45989:(e,t,r)=>{r.d(t,{S:()=>u,n:()=>o});var n=r(11185),i=r.n(n);let a=new(i()).Schema({username:{type:String,required:!0,unique:!0,min:3,max:20},email:{type:String,required:!0,unique:!0,max:50},password:{type:String,required:!0},img:{type:String},isAdmin:{type:Boolean,default:!1}},{timestamps:!0}),s=new(i()).Schema({title:{type:String,required:!0},desc:{type:String,required:!0},img:{type:String},userId:{type:String,required:!0},slug:{type:String,required:!0,unique:!0}},{timestamps:!0}),o=i().models?.User||i().model("User",a),u=i().models?.Post||i().model("Post",s)},78596:(e,t,r)=>{r.d(t,{T:()=>s});var n=r(11185),i=r.n(n);let a={},s=async()=>{try{if(a.isConnected){console.log("Using existing connection");return}let e=await i().connect(process.env.MONGO);a.isConnected=e.connections[0].readyState}catch(e){throw console.log(e),Error(e)}}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[385,406],()=>r(45644));module.exports=n})();