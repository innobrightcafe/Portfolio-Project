(()=>{var e={};e.id=128,e.ids=[128],e.modules={11185:e=>{"use strict";e.exports=require("mongoose")},47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},14300:e=>{"use strict";e.exports=require("buffer")},6113:e=>{"use strict";e.exports=require("crypto")},82361:e=>{"use strict";e.exports=require("events")},13685:e=>{"use strict";e.exports=require("http")},95687:e=>{"use strict";e.exports=require("https")},73837:e=>{"use strict";e.exports=require("util")},59796:e=>{"use strict";e.exports=require("zlib")},64173:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>s.a,__next_app__:()=>u,originalPathname:()=>b,pages:()=>l,routeModule:()=>f,tree:()=>d});var n=r(50482),o=r(69108),a=r(62563),s=r.n(a),i=r(68300),c={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>i[e]);r.d(t,c);let d=["",{children:["(pages)",{children:["(auth)",{children:["login",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,74438)),"/home/inosoft/Documents/project/ALXFINALPROJECT/Portfolio-Project/code/src/app/(pages)/(auth)/login/page.jsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,89888)),"/home/inosoft/Documents/project/ALXFINALPROJECT/Portfolio-Project/code/src/app/(pages)/layout.js"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,73414)),"/home/inosoft/Documents/project/ALXFINALPROJECT/Portfolio-Project/code/src/app/layout.js"],error:[()=>Promise.resolve().then(r.bind(r,6510)),"/home/inosoft/Documents/project/ALXFINALPROJECT/Portfolio-Project/code/src/app/error.jsx"],loading:[()=>Promise.resolve().then(r.bind(r,25536)),"/home/inosoft/Documents/project/ALXFINALPROJECT/Portfolio-Project/code/src/app/loading.jsx"],"not-found":[()=>Promise.resolve().then(r.bind(r,10870)),"/home/inosoft/Documents/project/ALXFINALPROJECT/Portfolio-Project/code/src/app/not-found.jsx"]}],l=["/home/inosoft/Documents/project/ALXFINALPROJECT/Portfolio-Project/code/src/app/(pages)/(auth)/login/page.jsx"],b="/(pages)/(auth)/login/page",u={require:r,loadChunk:()=>Promise.resolve()},f=new n.AppPageRouteModule({definition:{kind:o.x.APP_PAGE,page:"/(pages)/(auth)/login/page",pathname:"/login",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},22024:(e,t,r)=>{let n={"085ea23afbe1f79ea92722241c367e2f34457e8e":()=>Promise.resolve().then(r.bind(r,63618)).then(e=>e.handleLogout),"50633a6b2b7c837fa5bac1d52be8c5a6f10f40dc":()=>Promise.resolve().then(r.bind(r,63618)).then(e=>e.updatePost),"73c00ffcb152cc7e6e6892bf27ca1f7dd3853134":()=>Promise.resolve().then(r.bind(r,63618)).then(e=>e.login),"7d01890afc25905fc7fc58cc47ae2ea7ea38d43c":()=>Promise.resolve().then(r.bind(r,63618)).then(e=>e.addUser),"83b66770bbb46faa976b9a0b11a5ba957dba1a74":()=>Promise.resolve().then(r.bind(r,63618)).then(e=>e.handleGithubLogin),cc3d0dad1685d5a813afdfb674c61754ed4f3b95:()=>Promise.resolve().then(r.bind(r,63618)).then(e=>e.deleteUser),d2fb99837482f29ff68456e56434004214665788:()=>Promise.resolve().then(r.bind(r,63618)).then(e=>e.addPost),dcd26091b7b87ab99b253e551c87101fe6a0d947:()=>Promise.resolve().then(r.bind(r,63618)).then(e=>e.deletePost),e38b09b1a75bd98ac80ff08e47ef888884b96026:()=>Promise.resolve().then(r.bind(r,63618)).then(e=>e.register)};async function o(e,...t){return(await n[e]()).apply(null,t)}e.exports={"085ea23afbe1f79ea92722241c367e2f34457e8e":o.bind(null,"085ea23afbe1f79ea92722241c367e2f34457e8e"),"50633a6b2b7c837fa5bac1d52be8c5a6f10f40dc":o.bind(null,"50633a6b2b7c837fa5bac1d52be8c5a6f10f40dc"),"73c00ffcb152cc7e6e6892bf27ca1f7dd3853134":o.bind(null,"73c00ffcb152cc7e6e6892bf27ca1f7dd3853134"),"7d01890afc25905fc7fc58cc47ae2ea7ea38d43c":o.bind(null,"7d01890afc25905fc7fc58cc47ae2ea7ea38d43c"),"83b66770bbb46faa976b9a0b11a5ba957dba1a74":o.bind(null,"83b66770bbb46faa976b9a0b11a5ba957dba1a74"),cc3d0dad1685d5a813afdfb674c61754ed4f3b95:o.bind(null,"cc3d0dad1685d5a813afdfb674c61754ed4f3b95"),d2fb99837482f29ff68456e56434004214665788:o.bind(null,"d2fb99837482f29ff68456e56434004214665788"),dcd26091b7b87ab99b253e551c87101fe6a0d947:o.bind(null,"dcd26091b7b87ab99b253e551c87101fe6a0d947"),e38b09b1a75bd98ac80ff08e47ef888884b96026:o.bind(null,"e38b09b1a75bd98ac80ff08e47ef888884b96026")}},69275:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,61476,23)),Promise.resolve().then(r.bind(r,98801))},92321:(e,t,r)=>{Promise.resolve().then(r.bind(r,4473))},4473:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>l});var n=r(95344),o=r(93377),a=r.n(o),s=r(81202),i=r(20783),c=r.n(i),d=r(63623);let l=async()=>{let[e,t]=(0,s.useFormState)(d.x4,void 0),r=await (0,d.F$)();return(0,n.jsxs)("form",{className:a().form,action:t,children:[n.jsx("input",{type:"text",placeholder:"username",name:"username"}),n.jsx("input",{type:"password",placeholder:"password",name:"password"}),e?.error,n.jsx("button",{className:a().btn,type:"submit",children:"Login"}),n.jsx("form",{action:r,children:n.jsx("button",{className:a().github,children:"Or Login with Github "})}),(0,n.jsxs)(c(),{href:"/register",children:["Don't have an account?"," ",n.jsx("b",{children:"Register"})]})]})}},96035:e=>{e.exports={container:"login_container__bvah3",wrapper:"login_wrapper__WK2Fg"}},93377:e=>{e.exports={form:"loginForm_form__gv3hk",btn:"loginForm_btn__1F4Pg",github:"loginForm_github__Fz8eS"}},74438:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>l});var n=r(25036);let o=(0,r(86843).createProxy)(String.raw`/home/inosoft/Documents/project/ALXFINALPROJECT/Portfolio-Project/code/src/components/loginForm/loginForm.jsx`),{__esModule:a,$$typeof:s}=o,i=o.default;var c=r(96035),d=r.n(c);let l=()=>n.jsx("div",{className:d().container,children:(0,n.jsxs)("div",{className:d().wrapper,children:[n.jsx("h3",{children:"Welcome Back "}),n.jsx("p",{children:"Please Enter Your credentials To Login"}),n.jsx(i,{})]})})},89888:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>a});var n=r(25036);r(5023);var o=r(21689);function a({children:e}){return(0,n.jsxs)("div",{className:"container",children:[n.jsx(o.Z,{}),n.jsx("div",{children:e})]})}},63618:(e,t,r)=>{"use strict";r.r(t),r.d(t,{addPost:()=>b,addUser:()=>m,deletePost:()=>u,deleteUser:()=>p,handleGithubLogin:()=>g,handleLogout:()=>h,login:()=>x,register:()=>P,updatePost:()=>f});var n=r(98601);r(75811);var o=r(43811),a=r(29560),s=r(29699),i=r(96331),c=r(30634),d=r.n(c),l=r(17824);let b=async(e,t)=>{let{title:r,desc:n,slug:i,userId:c}=Object.fromEntries(t);try{(0,s.connectToDb)();let e=new a.Post({title:r,desc:n,slug:i,userId:c});await e.save(),console.log("saved to db"),(0,o.revalidatePath)("/blog"),(0,o.revalidatePath)("/admin")}catch(e){return console.log(e),{error:"Something went wrong!"}}},u=async e=>{let{id:t}=Object.fromEntries(e);try{(0,s.connectToDb)(),await a.Post.findByIdAndDelete(t),console.log("deleted from db"),(0,o.revalidatePath)("/blog"),(0,o.revalidatePath)("/admin")}catch(e){return console.log(e),{error:"Something went wrong!"}}},f=async e=>{let{id:t}=Object.fromEntries(e);try{(0,s.connectToDb)(),await a.Post.findByIdAndUpdate(t),console.log("updated successfully"),(0,o.revalidatePath)("/blog"),(0,o.revalidatePath)("/admin")}catch(e){return console.log(e),{error:"Something went wrong!"}}},m=async(e,t)=>{let{username:r,email:n,password:i,img:c}=Object.fromEntries(t);try{(0,s.connectToDb)();let e=new a.User({username:r,email:n,password:i,img:c});await e.save(),console.log("saved to db"),(0,o.revalidatePath)("/admin")}catch(e){return console.log(e),{error:"Something went wrong!"}}},p=async e=>{let{id:t}=Object.fromEntries(e);try{(0,s.connectToDb)(),await a.Post.deleteMany({userId:t}),await a.User.findByIdAndDelete(t),console.log("deleted from db"),(0,o.revalidatePath)("/admin")}catch(e){return console.log(e),{error:"Something went wrong!"}}},g=async()=>{await (0,i.signIn)("github")},h=async()=>{await (0,i.signOut)()},P=async(e,t)=>{let{username:r,email:n,password:o,img:i,passwordRepeat:c}=Object.fromEntries(t);if(o!==c)return{error:"Passwords do not match"};try{if((0,s.connectToDb)(),await a.User.findOne({username:r}))return{error:"Username already exists"};let e=await d().genSalt(10),t=await d().hash(o,e),c=new a.User({username:r,email:n,password:t,img:i});return await c.save(),console.log("saved to db"),{success:!0}}catch(e){return console.log(e),{error:"Something went wrong!"}}},x=async(e,t)=>{let{username:r,password:n}=Object.fromEntries(t);try{await (0,i.signIn)("credentials",{username:r,password:n})}catch(e){if(console.log(e),e.message.includes("CredentialsSignin"))return{error:"Invalid username or password"};throw e}};(0,l.ensureServerEntryExports)([b,u,f,m,p,g,h,P,x]),(0,n.createActionProxy)("d2fb99837482f29ff68456e56434004214665788",b),(0,n.createActionProxy)("dcd26091b7b87ab99b253e551c87101fe6a0d947",u),(0,n.createActionProxy)("50633a6b2b7c837fa5bac1d52be8c5a6f10f40dc",f),(0,n.createActionProxy)("7d01890afc25905fc7fc58cc47ae2ea7ea38d43c",m),(0,n.createActionProxy)("cc3d0dad1685d5a813afdfb674c61754ed4f3b95",p),(0,n.createActionProxy)("83b66770bbb46faa976b9a0b11a5ba957dba1a74",g),(0,n.createActionProxy)("085ea23afbe1f79ea92722241c367e2f34457e8e",h),(0,n.createActionProxy)("e38b09b1a75bd98ac80ff08e47ef888884b96026",P),(0,n.createActionProxy)("73c00ffcb152cc7e6e6892bf27ca1f7dd3853134",x)},8805:(e,t,r)=>{"use strict";r.d(t,{authConfig:()=>n});let n={pages:{signIn:"/login"},providers:[],callbacks:{jwt:async({token:e,user:t})=>(t&&(e.id=t.id,e.isAdmin=t.isAdmin),e),session:async({session:e,token:t})=>(t&&(e.user.id=t.id,e.user.isAdmin=t.isAdmin),e),authorized({auth:e,request:t}){let r=e?.user,n=t.nextUrl?.pathname.startsWith("/admin"),o=t.nextUrl?.pathname.startsWith("/blog"),a=t.nextUrl?.pathname.startsWith("/login");return(!n||!!r?.isAdmin)&&(!o||!!r)&&(!a||!r||Response.redirect(new URL("/",t.nextUrl)))}}}},96331:(e,t,r)=>{"use strict";r.d(t,{signIn:()=>p,signOut:()=>g});var n=r(29538),o=r(24320),a=r(76714),s=r(29699),i=r(29560),c=r(30634),d=r.n(c),l=r(8805);let b=async e=>{try{(0,s.connectToDb)();let t=await i.User.findOne({username:e.username});if(!t||!await d().compare(e.password,t.password))throw Error("Wrong credentials!");return t}catch(e){throw console.log(e),Error("Failed to login!")}},{handlers:{GET:u,POST:f},auth:m,signIn:p,signOut:g}=(0,n.default)({...l.authConfig,providers:[(0,o.default)({clientId:process.env.GITHUB_ID,clientSecret:process.env.GITHUB_SECRET}),(0,a.default)({async authorize(e){try{return await b(e)}catch(e){return null}}})],callbacks:{async signIn({user:e,account:t,profile:r}){if("github"===t.provider){(0,s.connectToDb)();try{if(!await i.User.findOne({email:r.email})){let e=new i.User({username:r.login,email:r.email,image:r.avatar_url});await e.save()}}catch(e){return console.log(e),!1}}return!0},...l.authConfig.callbacks}})},29560:(e,t,r)=>{"use strict";r.d(t,{Post:()=>c,User:()=>i});var n=r(11185),o=r.n(n);let a=new(o()).Schema({username:{type:String,required:!0,unique:!0,min:3,max:20},email:{type:String,required:!0,unique:!0,max:50},password:{type:String,required:!0},img:{type:String},isAdmin:{type:Boolean,default:!1}},{timestamps:!0}),s=new(o()).Schema({title:{type:String,required:!0},desc:{type:String,required:!0},img:{type:String},userId:{type:String,required:!0},slug:{type:String,required:!0,unique:!0}},{timestamps:!0}),i=o().models?.User||o().model("User",a),c=o().models?.Post||o().model("Post",s)},29699:(e,t,r)=>{"use strict";r.d(t,{connectToDb:()=>s});var n=r(11185),o=r.n(n);let a={},s=async()=>{try{if(a.isConnected){console.log("Using existing connection");return}let e=await o().connect(process.env.MONGO);a.isConnected=e.connections[0].readyState}catch(e){throw console.log(e),Error(e)}}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[385,406,461,485,298],()=>r(64173));module.exports=n})();