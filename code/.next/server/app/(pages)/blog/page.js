(()=>{var e={};e.id=377,e.ids=[377],e.modules={11185:e=>{"use strict";e.exports=require("mongoose")},47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},14300:e=>{"use strict";e.exports=require("buffer")},6113:e=>{"use strict";e.exports=require("crypto")},82361:e=>{"use strict";e.exports=require("events")},13685:e=>{"use strict";e.exports=require("http")},95687:e=>{"use strict";e.exports=require("https")},73837:e=>{"use strict";e.exports=require("util")},59796:e=>{"use strict";e.exports=require("zlib")},93920:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>s.a,__next_app__:()=>f,originalPathname:()=>b,pages:()=>l,routeModule:()=>u,tree:()=>d});var a=r(50482),o=r(69108),n=r(62563),s=r.n(n),i=r(68300),c={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>i[e]);r.d(t,c);let d=["",{children:["(pages)",{children:["blog",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,96394)),"/home/inosoft/Documents/project/ALXFINALPROJECT/Portfolio-Project/code/src/app/(pages)/blog/page.jsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,89888)),"/home/inosoft/Documents/project/ALXFINALPROJECT/Portfolio-Project/code/src/app/(pages)/layout.js"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,73414)),"/home/inosoft/Documents/project/ALXFINALPROJECT/Portfolio-Project/code/src/app/layout.js"],error:[()=>Promise.resolve().then(r.bind(r,6510)),"/home/inosoft/Documents/project/ALXFINALPROJECT/Portfolio-Project/code/src/app/error.jsx"],loading:[()=>Promise.resolve().then(r.bind(r,25536)),"/home/inosoft/Documents/project/ALXFINALPROJECT/Portfolio-Project/code/src/app/loading.jsx"],"not-found":[()=>Promise.resolve().then(r.bind(r,10870)),"/home/inosoft/Documents/project/ALXFINALPROJECT/Portfolio-Project/code/src/app/not-found.jsx"]}],l=["/home/inosoft/Documents/project/ALXFINALPROJECT/Portfolio-Project/code/src/app/(pages)/blog/page.jsx"],b="/(pages)/blog/page",f={require:r,loadChunk:()=>Promise.resolve()},u=new a.AppPageRouteModule({definition:{kind:o.x.APP_PAGE,page:"/(pages)/blog/page",pathname:"/blog",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},22024:(e,t,r)=>{let a={"085ea23afbe1f79ea92722241c367e2f34457e8e":()=>Promise.resolve().then(r.bind(r,63618)).then(e=>e.handleLogout),"50633a6b2b7c837fa5bac1d52be8c5a6f10f40dc":()=>Promise.resolve().then(r.bind(r,63618)).then(e=>e.updatePost),"73c00ffcb152cc7e6e6892bf27ca1f7dd3853134":()=>Promise.resolve().then(r.bind(r,63618)).then(e=>e.login),"7d01890afc25905fc7fc58cc47ae2ea7ea38d43c":()=>Promise.resolve().then(r.bind(r,63618)).then(e=>e.addUser),"83b66770bbb46faa976b9a0b11a5ba957dba1a74":()=>Promise.resolve().then(r.bind(r,63618)).then(e=>e.handleGithubLogin),cc3d0dad1685d5a813afdfb674c61754ed4f3b95:()=>Promise.resolve().then(r.bind(r,63618)).then(e=>e.deleteUser),d2fb99837482f29ff68456e56434004214665788:()=>Promise.resolve().then(r.bind(r,63618)).then(e=>e.addPost),dcd26091b7b87ab99b253e551c87101fe6a0d947:()=>Promise.resolve().then(r.bind(r,63618)).then(e=>e.deletePost),e38b09b1a75bd98ac80ff08e47ef888884b96026:()=>Promise.resolve().then(r.bind(r,63618)).then(e=>e.register)};async function o(e,...t){return(await a[e]()).apply(null,t)}e.exports={"085ea23afbe1f79ea92722241c367e2f34457e8e":o.bind(null,"085ea23afbe1f79ea92722241c367e2f34457e8e"),"50633a6b2b7c837fa5bac1d52be8c5a6f10f40dc":o.bind(null,"50633a6b2b7c837fa5bac1d52be8c5a6f10f40dc"),"73c00ffcb152cc7e6e6892bf27ca1f7dd3853134":o.bind(null,"73c00ffcb152cc7e6e6892bf27ca1f7dd3853134"),"7d01890afc25905fc7fc58cc47ae2ea7ea38d43c":o.bind(null,"7d01890afc25905fc7fc58cc47ae2ea7ea38d43c"),"83b66770bbb46faa976b9a0b11a5ba957dba1a74":o.bind(null,"83b66770bbb46faa976b9a0b11a5ba957dba1a74"),cc3d0dad1685d5a813afdfb674c61754ed4f3b95:o.bind(null,"cc3d0dad1685d5a813afdfb674c61754ed4f3b95"),d2fb99837482f29ff68456e56434004214665788:o.bind(null,"d2fb99837482f29ff68456e56434004214665788"),dcd26091b7b87ab99b253e551c87101fe6a0d947:o.bind(null,"dcd26091b7b87ab99b253e551c87101fe6a0d947"),e38b09b1a75bd98ac80ff08e47ef888884b96026:o.bind(null,"e38b09b1a75bd98ac80ff08e47ef888884b96026")}},75054:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,31900,23)),Promise.resolve().then(r.t.bind(r,61476,23))},69275:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,61476,23)),Promise.resolve().then(r.bind(r,98801))},1978:e=>{e.exports={container:"blog_container__fjxzH",post:"blog_post__lXNxC"}},65001:e=>{e.exports={container:"postCard_container__yIWzy",top:"postCard_top__jr3dE",imgContainer:"postCard_imgContainer__KGEEZ",img:"postCard_img__TTypP",date:"postCard_date__pzBxf",title:"postCard_title__95FgI",desc:"postCard_desc__jqCqC",link:"postCard_link__xorsS"}},96394:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>p});var a=r(25036),o=r(15904),n=r.n(o),s=r(65001),i=r.n(s),c=r(40646),d=r.n(c);let l=({post:e})=>(0,a.jsxs)("div",{className:i().container,children:[(0,a.jsxs)("div",{className:i().top,children:[e.img&&a.jsx("div",{className:i().imgContainer,children:a.jsx(n(),{src:e.img,alt:"",fill:!0,className:i().img})}),a.jsx("span",{className:i().date,children:e.createdAt?.toString().slice(4,16)})]}),(0,a.jsxs)("div",{className:i().bottom,children:[a.jsx("h1",{className:i().title,children:e.title}),a.jsx("p",{className:i().desc,children:e.body}),a.jsx(d(),{className:i().link,href:`/blog/${e.slug}`,children:"READ MORE"})]})]});var b=r(1978),f=r.n(b);r(94099);let u=async()=>{let e=await fetch("http://localhost:3000/api/blog",{next:{revalidate:3600}});if(!e.ok)throw Error("Something went wrong");return e.json()},p=async()=>{let e=await u();return a.jsx("div",{className:f().container,children:e.map(e=>a.jsx("div",{className:f().post,children:a.jsx(l,{post:e})},e.id))})}},89888:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>n});var a=r(25036);r(5023);var o=r(21689);function n({children:e}){return(0,a.jsxs)("div",{className:"container",children:[a.jsx(o.Z,{}),a.jsx("div",{children:e})]})}},63618:(e,t,r)=>{"use strict";r.r(t),r.d(t,{addPost:()=>b,addUser:()=>p,deletePost:()=>f,deleteUser:()=>g,handleGithubLogin:()=>m,handleLogout:()=>h,login:()=>x,register:()=>P,updatePost:()=>u});var a=r(98601);r(75811);var o=r(43811),n=r(29560),s=r(29699),i=r(96331),c=r(30634),d=r.n(c),l=r(17824);let b=async(e,t)=>{let{title:r,desc:a,slug:i,userId:c}=Object.fromEntries(t);try{(0,s.connectToDb)();let e=new n.Post({title:r,desc:a,slug:i,userId:c});await e.save(),console.log("saved to db"),(0,o.revalidatePath)("/blog"),(0,o.revalidatePath)("/admin")}catch(e){return console.log(e),{error:"Something went wrong!"}}},f=async e=>{let{id:t}=Object.fromEntries(e);try{(0,s.connectToDb)(),await n.Post.findByIdAndDelete(t),console.log("deleted from db"),(0,o.revalidatePath)("/blog"),(0,o.revalidatePath)("/admin")}catch(e){return console.log(e),{error:"Something went wrong!"}}},u=async e=>{let{id:t}=Object.fromEntries(e);try{(0,s.connectToDb)(),await n.Post.findByIdAndUpdate(t),console.log("updated successfully"),(0,o.revalidatePath)("/blog"),(0,o.revalidatePath)("/admin")}catch(e){return console.log(e),{error:"Something went wrong!"}}},p=async(e,t)=>{let{username:r,email:a,password:i,img:c}=Object.fromEntries(t);try{(0,s.connectToDb)();let e=new n.User({username:r,email:a,password:i,img:c});await e.save(),console.log("saved to db"),(0,o.revalidatePath)("/admin")}catch(e){return console.log(e),{error:"Something went wrong!"}}},g=async e=>{let{id:t}=Object.fromEntries(e);try{(0,s.connectToDb)(),await n.Post.deleteMany({userId:t}),await n.User.findByIdAndDelete(t),console.log("deleted from db"),(0,o.revalidatePath)("/admin")}catch(e){return console.log(e),{error:"Something went wrong!"}}},m=async()=>{await (0,i.signIn)("github")},h=async()=>{await (0,i.signOut)()},P=async(e,t)=>{let{username:r,email:a,password:o,img:i,passwordRepeat:c}=Object.fromEntries(t);if(o!==c)return{error:"Passwords do not match"};try{if((0,s.connectToDb)(),await n.User.findOne({username:r}))return{error:"Username already exists"};let e=await d().genSalt(10),t=await d().hash(o,e),c=new n.User({username:r,email:a,password:t,img:i});return await c.save(),console.log("saved to db"),{success:!0}}catch(e){return console.log(e),{error:"Something went wrong!"}}},x=async(e,t)=>{let{username:r,password:a}=Object.fromEntries(t);try{await (0,i.signIn)("credentials",{username:r,password:a})}catch(e){if(console.log(e),e.message.includes("CredentialsSignin"))return{error:"Invalid username or password"};throw e}};(0,l.ensureServerEntryExports)([b,f,u,p,g,m,h,P,x]),(0,a.createActionProxy)("d2fb99837482f29ff68456e56434004214665788",b),(0,a.createActionProxy)("dcd26091b7b87ab99b253e551c87101fe6a0d947",f),(0,a.createActionProxy)("50633a6b2b7c837fa5bac1d52be8c5a6f10f40dc",u),(0,a.createActionProxy)("7d01890afc25905fc7fc58cc47ae2ea7ea38d43c",p),(0,a.createActionProxy)("cc3d0dad1685d5a813afdfb674c61754ed4f3b95",g),(0,a.createActionProxy)("83b66770bbb46faa976b9a0b11a5ba957dba1a74",m),(0,a.createActionProxy)("085ea23afbe1f79ea92722241c367e2f34457e8e",h),(0,a.createActionProxy)("e38b09b1a75bd98ac80ff08e47ef888884b96026",P),(0,a.createActionProxy)("73c00ffcb152cc7e6e6892bf27ca1f7dd3853134",x)},8805:(e,t,r)=>{"use strict";r.d(t,{authConfig:()=>a});let a={pages:{signIn:"/login"},providers:[],callbacks:{jwt:async({token:e,user:t})=>(t&&(e.id=t.id,e.isAdmin=t.isAdmin),e),session:async({session:e,token:t})=>(t&&(e.user.id=t.id,e.user.isAdmin=t.isAdmin),e),authorized({auth:e,request:t}){let r=e?.user,a=t.nextUrl?.pathname.startsWith("/admin"),o=t.nextUrl?.pathname.startsWith("/blog"),n=t.nextUrl?.pathname.startsWith("/login");return(!a||!!r?.isAdmin)&&(!o||!!r)&&(!n||!r||Response.redirect(new URL("/",t.nextUrl)))}}}},96331:(e,t,r)=>{"use strict";r.d(t,{signIn:()=>g,signOut:()=>m});var a=r(29538),o=r(24320),n=r(76714),s=r(29699),i=r(29560),c=r(30634),d=r.n(c),l=r(8805);let b=async e=>{try{(0,s.connectToDb)();let t=await i.User.findOne({username:e.username});if(!t||!await d().compare(e.password,t.password))throw Error("Wrong credentials!");return t}catch(e){throw console.log(e),Error("Failed to login!")}},{handlers:{GET:f,POST:u},auth:p,signIn:g,signOut:m}=(0,a.default)({...l.authConfig,providers:[(0,o.default)({clientId:process.env.GITHUB_ID,clientSecret:process.env.GITHUB_SECRET}),(0,n.default)({async authorize(e){try{return await b(e)}catch(e){return null}}})],callbacks:{async signIn({user:e,account:t,profile:r}){if("github"===t.provider){(0,s.connectToDb)();try{if(!await i.User.findOne({email:r.email})){let e=new i.User({username:r.login,email:r.email,image:r.avatar_url});await e.save()}}catch(e){return console.log(e),!1}}return!0},...l.authConfig.callbacks}})},94099:(e,t,r)=>{"use strict";r.d(t,{Jq:()=>s,PR:()=>c,Rf:()=>d,xl:()=>i});var a=r(45989),o=r(78596),n=r(66864);let s=async()=>{try{return(0,o.T)(),await a.S.find()}catch(e){throw console.log(e),Error("Failed to fetch posts!")}},i=async e=>{try{return(0,o.T)(),await a.S.findOne({slug:e})}catch(e){throw console.log(e),Error("Failed to fetch post!")}},c=async e=>{(0,n.unstable_noStore)();try{return(0,o.T)(),await a.n.findById(e)}catch(e){throw console.log(e),Error("Failed to fetch user!")}},d=async()=>{try{return(0,o.T)(),await a.n.find()}catch(e){throw console.log(e),Error("Failed to fetch users!")}}},29560:(e,t,r)=>{"use strict";r.d(t,{Post:()=>c,User:()=>i});var a=r(11185),o=r.n(a);let n=new(o()).Schema({username:{type:String,required:!0,unique:!0,min:3,max:20},email:{type:String,required:!0,unique:!0,max:50},password:{type:String,required:!0},img:{type:String},isAdmin:{type:Boolean,default:!1}},{timestamps:!0}),s=new(o()).Schema({title:{type:String,required:!0},desc:{type:String,required:!0},img:{type:String},userId:{type:String,required:!0},slug:{type:String,required:!0,unique:!0}},{timestamps:!0}),i=o().models?.User||o().model("User",n),c=o().models?.Post||o().model("Post",s)},29699:(e,t,r)=>{"use strict";r.d(t,{connectToDb:()=>s});var a=r(11185),o=r.n(a);let n={},s=async()=>{try{if(n.isConnected){console.log("Using existing connection");return}let e=await o().connect(process.env.MONGO);n.isConnected=e.connections[0].readyState}catch(e){throw console.log(e),Error(e)}}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[385,406,461,485,904,864,298],()=>r(93920));module.exports=a})();